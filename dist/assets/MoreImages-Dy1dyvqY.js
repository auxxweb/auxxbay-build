import{ac as X,j as e,u as ee,ad as se,ae as le,r as n,ah as p,ag as L,aL as te,aM as I,aj as $}from"./index-DChezozi.js";import{C as oe,g as ce}from"./cropper.utils-CAPiAWlv.js";const re=X(e.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),ae={infinite:!0,speed:500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]},ne=10,R={file:null,fileType:"",fileName:"",accessLink:""},A={x:0,y:0},pe=()=>{var b,k,N;const m=ee(),j=se(),l=le(s=>s.business),[T,g]=n.useState(!1),[U,x]=n.useState(!1),[o,i]=n.useState([R]),[E,v]=n.useState(A),[F,P]=n.useState(1),[S,_]=n.useState(null),[B,h]=n.useState(!1),[f,G]=n.useState(null),[y,M]=n.useState(null),z=(s,t)=>{_(t)},D=async()=>{var s;try{if(x(!0),f>=0){const t=(s=o==null?void 0:o[f])==null?void 0:s.file,{blob:r}=await ce(y,S),c=new File([r],(t==null?void 0:t.name)||"cropped-logo.png",{type:r.type});i(a=>{const u=[...a];return u[f].file=c,u}),v(A)}x(!1)}catch(t){x(!1),console.error("Error cropping image:",t)}finally{h(!1)}},O=(s,t)=>{const r=t.target.files[0];if(r){const c=new FileReader;G(s),c.onload=async a=>{M(a.target.result),h(!0)},c.readAsDataURL(r)}},W=()=>{i(s=>[...s,{file:null,fileType:"",fileName:""}])},Y=s=>{document.getElementById(`file-input-${s}`).click()},Z=s=>{if((o==null?void 0:o.length)>1){const t=o.filter((r,c)=>c!==s);i(t)}else i([{file:null,fileType:"",fileName:""}])},q=async()=>{const s=o==null?void 0:o.filter(({accessLink:c})=>!c),t=s==null?void 0:s.map(({file:c})=>c),r=s==null?void 0:s.map(({file:c})=>c).filter(c=>c!=null);if(console.log(r,"imageFiles"),(r==null?void 0:r.length)>0){g(!0);const c={files:t==null?void 0:t.map(a=>({position:"gallery",file_type:a.type}))};try{const w=(await I.post("https://server.auxxweb.in/api/v1/s3url",c,{headers:{"Content-Type":"application/json"}})).data.data;await Promise.all(w.map(async(d,Q)=>{const{url:V}=d,C=t[Q];await I.put(V,C,{headers:{"Content-Type":C.type}})}));const H=w.map(d=>d.accessLink),K=o.map(d=>d.accessLink?d.accessLink:H.shift());j($({gallery:K})),m("/create-business/subscription")}catch(a){console.error("Error fetching S3 URLs or uploading files:",a)}finally{g(!1)}}else{if(o.length!==0){const c=[];o.map(a=>c.push(a==null?void 0:a.accessLink)),j($({gallery:c}))}m("/create-business/subscription")}},J=()=>m("/create-business/seo");return n.useEffect(()=>{var s,t;((s=l==null?void 0:l.gallery)==null?void 0:s.length)>0?i((t=l==null?void 0:l.gallery)==null?void 0:t.map(r=>({accessLink:r}))):i([R])},[l]),e.jsxs("div",{className:"h-100vh create-business-div",children:[B&&e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",role:"dialog",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Crop Your Image"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:()=>h(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"cropper-container position-relative",style:{height:"400px"},children:e.jsx(oe,{image:y,crop:E,zoom:F,aspect:4/5,onCropChange:v,onZoomChange:P,onCropComplete:z})})}),e.jsxs("div",{className:"modal-footer ",children:[e.jsx(p,{variant:"contained",className:"mx-2 bg-danger border-danger",onClick:()=>h(!1),children:"Cancel"}),U?e.jsx(L,{variant:"primary"}):e.jsx(p,{variant:"contained",className:"mx-2",onClick:D,children:"Save Crop"})]})]})})}),e.jsxs("div",{className:"row h-100 justify-content-center",children:[e.jsxs("div",{className:"col-12 col-md-6 row align-items-end justify-content-center h-100 p-3 p-md-5 right-portion",children:[e.jsx("div",{className:"col-12 text-start",children:e.jsx("button",{className:"btn btn-dark w-auto float-start",onClick:J,children:e.jsx("i",{className:"bi bi-arrow-left"})})}),e.jsxs("div",{className:"row justify-content-start",children:[e.jsx("div",{className:"col-12 text-center text-md-start mt-4",children:e.jsxs("h1",{className:"fw-bold title-text",children:[e.jsx("span",{className:"title-main",children:"Add "}),e.jsx("span",{className:"title-highlight",children:"Gallery"})]})}),e.jsxs("div",{className:"col-12  flex justify-content-start",children:[e.jsx("div",{className:"row mb-3 gap-2",children:o.map((s,t)=>e.jsxs("div",{className:"col-4 col-md-3 mb-3 mx-2 text-center",children:[e.jsx("input",{type:"file",hidden:!0,id:`file-input-${t}`,accept:"image/*",onChange:r=>O(t,r)}),e.jsxs("div",{className:"p-2 add-logo-div ",children:[(o==null?void 0:o.length)>1||s.file?e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(re,{style:{top:"10px",right:"10px",cursor:"pointer",color:"#ff4d4f",fontSize:"18px",fontWeight:"bold",zIndex:9},onClick:()=>Z(t)})}):e.jsx("div",{style:{height:"1.5rem"}}),e.jsxs("div",{className:"text-center",onClick:()=>Y(t),children:[e.jsx("span",{style:{color:"grey"},children:"(Ratio 4 : 5)"}),s!=null&&s.file||s!=null&&s.accessLink?e.jsx("img",{src:s!=null&&s.file?URL.createObjectURL(s==null?void 0:s.file):s==null?void 0:s.accessLink,alt:`Uploaded Preview ${t}`,className:"img-preview",width:"100",height:"80",style:{objectFit:"cover"}}):e.jsx("img",{src:"/images/add_image.png",width:"50",alt:"Add Image",className:"mx-auto",style:{height:"70px",objectFit:"contain"}})]})]})]},t))}),(o==null?void 0:o.length)<ne&&e.jsx(p,{variant:"contained",className:"w-100 submit-button",onClick:W,children:"+ Add another image"})]})]}),e.jsx("div",{className:"col-12 text-center ",children:T?e.jsx(L,{variant:"primary"}):e.jsx(p,{variant:"contained",className:"w-100 submit-button",onClick:q,children:"Save & Next"})})]}),e.jsxs("div",{className:"d-none d-md-block left-portion p-0 col-md-6 h-100",children:[e.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),e.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:!0}),e.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap",rel:"stylesheet"}),e.jsxs("style",{children:[" ",`
                                ::-webkit-scrollbar {
                                    width: 12px; /* Width of the entire scrollbar */
                                }
            
                                /* Scrollbar track */
                                ::-webkit-scrollbar-track {
                                    background: rgb(243, 243, 244); /* Background of the scrollbar track */
                                }::-webkit-scrollbar-thumb {
                                    background-color: ${l==null?void 0:l.theme}; /* Color of the scrollbar thumb */
                                    border-radius: 10px;     /* Rounded edges of the thumb */
                                    border: 3px solid  ${l==null?void 0:l.theme}; /* Padding around the thumb */
                                }
                            .theme
                            {
                                background-color: ${l==null?void 0:l.theme};
                                color: white;
                                border: none;
                            }.service-design.active{
                                background-color: ${l==null?void 0:l.theme};
                            }.address-section{
                            background-color:${l==null?void 0:l.theme};
                            }.address-logo i{
                            color: ${l==null?void 0:l.theme};
                            }.cat-option{
                                border-right: 1px dashed ${l==null?void 0:l.theme};
                            }.text-orange{
                                    color: ${l==null?void 0:l.theme};
                                }.dish-div:hover{
                                    background-color: ${l==null?void 0:l.theme};
                                    color:white;
                                }.product-section{
                                padding:20px;
                                border:1px solid ${l==null?void 0:l.theme};
                                border-radius:16px;
                                    }.slick-dots .slick-active button{
                                        background-color: ${l==null?void 0:l.theme};
                                        border-radius: 16px;
                                    }
                                `]}),e.jsx("section",{className:"h-auto david-font",style:{backgroundColor:"#F3F3F4"},children:e.jsx("div",{className:"container p-top",children:e.jsxs("div",{className:"col-12 mb-5",id:"gallery",children:[e.jsx("div",{className:"col-12 mb-5 mt-5",children:e.jsx("h1",{className:"fw-bold text-center",children:"Gallery"})}),o.length!==1?e.jsx(te,{...ae,className:"gallery-slider",children:o.map((s,t)=>s!=null&&s.file||s!=null&&s.accessLink?e.jsx("div",{className:"p-2",children:e.jsx("img",{src:s!=null&&s.file?URL.createObjectURL(s.file):s==null?void 0:s.accessLink,alt:"",className:"w-100 gallery-img"})},t):null)}):e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:!((b=o[0])!=null&&b.file)&&!((k=o[0])!=null&&k.accessLink)?e.jsx("img",{src:"/images/add_image.png",alt:""}):e.jsx("img",{className:"w-50",src:o[0].file?URL.createObjectURL((N=o[0])==null?void 0:N.file):o[0].accessLink,alt:""})})]})})})]})]})]})};export{pe as default};
