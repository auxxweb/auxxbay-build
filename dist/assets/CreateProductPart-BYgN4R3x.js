import{u as le,ad as oe,ae,r as n,j as e,ah as f,ag as R,aL as ie,aj as ce}from"./index-DChezozi.js";import{C as ne,g as de}from"./cropper.utils-CAPiAWlv.js";import{p as me}from"./s3url-dtrJtRcg.js";import{T as u}from"./TextField-C7oGFiCr.js";const je=()=>{var $,F,W;const k=le(),B=oe(),s=ae(t=>t.business),[o,m]=n.useState({title:"",description:"",data:[{title:"",description:"",image:"",price:"",link:""}]}),[b,y]=n.useState({specialService:{}}),[L,N]=n.useState(!1),[q,S]=n.useState(!1),[T]=n.useState([]),[z,O]=n.useState({x:0,y:0}),[D,J]=n.useState(1),[V,U]=n.useState(null),[Y,g]=n.useState(!1),[w,E]=n.useState(null),[he,Z]=n.useState(null),[_,X]=n.useState(null),[p,P]=n.useState({image:null,file:null,preview:null}),G=(t,r)=>{U(r)},H=async()=>{try{N(!0);const{fileUrl:t,blob:r}=await de(p==null?void 0:p.preview,V),c=new File([r],(w==null?void 0:w.name)||"cropped-logo.png",{type:r.type}),a=await me(c,"service");a!=null&&a.accessLink?m(i=>{const l=[...i.data];return l[_].image=a.accessLink,{...i,data:l}}):console.error("Access link not found in response."),Z(t),E(c)}catch(t){N(!1),console.error("Error cropping image:",t)}finally{N(!1),g(!1)}},j=(t,r)=>{const{name:c,value:a}=r.target;m(i=>{const l=[...i.data];l[t][c]=a;const h=l[t];return h.errors=C(h),{...i,data:l}})},K=async(t,r,c)=>{const a=c.target.files[0];if(a){y(l=>({...l,[t]:{...l[t],[r]:!0}}));const i=new FileReader;E(a),P(l=>({...l,file:a})),X(r),i.onload=async l=>{const h=l.target.result;P(v=>({...v,preview:h})),g(!0)},i.readAsDataURL(a),y(l=>({...l,[t]:{...l[t],[r]:!1}}))}else m(i=>{const l=[...i.data];return l[r].image=null,l[r].errors=C(l[r]),{...i,data:l}})},M=(t,r)=>{document.querySelectorAll(".specialServiceImageInput")[r].click()},x=(t,r)=>t?t.trim().split(/\s+/).length>r:!1,Q=t=>!!(t.title||t.description||t.price||t.image),C=t=>{const r={};return Q(t)&&(t.title?x(t.title,8)&&(r.titleError="Title exceeded the word limit."):r.titleError="Title is required.",t.description?x(t.description,50)&&(r.descriptionError="Description exceeded the word limit."):r.descriptionError="Description is required.",t.image||(r.imageError="Image is required.")),r},ee=()=>{let t=!0;if(m(r=>{const c=r.data.map(a=>{const i=C(a);return Object.keys(i).length>0&&(t=!1),{...a,errors:i}});return{...r,data:c}}),!t){toast.error("Please fill in the required fields.");return}S(!0),B(ce({productSection:o})),k("/create-business/seo"),S(!1)},I=t=>{const{name:r,value:c}=t.target;m(a=>({...a,[r]:c}))},te=t=>{m(r=>{const c=r.data.filter((a,i)=>i!==t);return{...r,data:c}})},re={dots:!1,autoplay:!0,arrows:!1,speed:500,slidesToShow:2,slidesToScroll:1,responsive:[{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0}},{breakpoint:768,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:390,settings:{slidesToShow:1,slidesToScroll:1}}]},se=()=>k("/create-business/services");return n.useEffect(()=>{m(JSON.parse(JSON.stringify(s==null?void 0:s.productSection)))},[s]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-100vh create-business-div",children:[Y&&e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",role:"dialog",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Crop Your Image"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:()=>g(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"cropper-container position-relative",style:{height:"400px"},children:e.jsx(ne,{image:p==null?void 0:p.preview,crop:z,zoom:D,aspect:4/3,onCropChange:O,onZoomChange:J,onCropComplete:G})})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx(f,{variant:"contained",className:"bg-danger border-danger mx-2",onClick:()=>g(!1),children:"Cancel"}),L?e.jsx(R,{variant:"primary"}):e.jsx(f,{variant:"contained",className:" mx-2",onClick:H,children:"Save Crop"})]})]})})}),e.jsxs("div",{className:"row h-100 justify-content-center",children:[e.jsxs("div",{className:"col-12 col-md-6 row align-items-end justify-content-center h-100 p-3 p-md-5 right-portion",children:[e.jsx("div",{className:"col-12 text-start",children:e.jsx("button",{className:"btn btn-dark w-auto float-start",onClick:se,children:e.jsx("i",{className:"bi bi-arrow-left"})})}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 mt-5 text-center text-md-start",children:e.jsxs("h1",{className:"fw-bold title-text title-main",children:["Add ",e.jsx("span",{className:"title-highlight",children:"Product Details"})]})}),e.jsxs("div",{className:"col-12",children:[e.jsx(u,{fullWidth:!0,className:"my-2",label:"Title (8 words)",id:"title-1",variant:"filled",name:"title",autoComplete:"title-1",onChange:I,error:x(o.title,8),helperText:x(o.title,8)?"exceeded the limit":"",value:o.title}),e.jsx(u,{fullWidth:!0,className:"my-2",label:"Description (50 words)",id:"description-1",variant:"filled",name:"description",autoComplete:"description-1",multiline:!0,rows:4,value:o.description,onChange:I,error:x(o.description,50),helperText:x(o.description,50)?"exceeded the limit":""}),e.jsx("hr",{style:{border:"2px solid #105193",borderRadius:"5px",margin:"35px 0"}}),e.jsx("div",{className:"col-12 text-center",children:e.jsx("h5",{className:"fs-18 mb-4 p-1 text-center text-md-start text-dark fw-bold mt-3",children:"Add Product Cards"})}),($=o==null?void 0:o.data)==null?void 0:$.map((t,r)=>{var c,a,i,l,h,v,A;return e.jsxs("div",{className:"mt-2 card p-3 pt-5 position-relative shadow-sm",style:{border:"1px solid #ddd",borderRadius:"8px"},children:[r<((c=o==null?void 0:o.data)==null?void 0:c.length)-1&&e.jsx("div",{onClick:()=>te(r),className:"remove-button position-absolute",style:{top:"10px",right:"10px",cursor:"pointer",color:"#ff4d4f",fontSize:"18px",fontWeight:"bold",zIndex:9},children:"X"}),r!==0&&e.jsx("div",{className:"divider"}),e.jsx(u,{fullWidth:!0,className:"my-2",label:"Title (8 words)",id:"title",variant:"filled",name:"title",autoComplete:"Service Name",value:t.title,onChange:d=>j(r,d),error:!!((a=t.errors)!=null&&a.titleError),helperText:((i=t.errors)==null?void 0:i.titleError)||""}),e.jsx(u,{fullWidth:!0,className:"my-2",label:"Description (50 words)",id:"description",variant:"filled",name:"description",autoComplete:"description",multiline:!0,rows:4,value:t.description,onChange:d=>j(r,d),error:!!((l=t.errors)!=null&&l.descriptionError),helperText:((h=t.errors)==null?void 0:h.descriptionError)||""}),e.jsx(u,{fullWidth:!0,className:"my-2",type:"number",id:"price",name:"price",variant:"filled",label:"Price",value:t.price,onChange:d=>j(r,d)}),e.jsx(u,{fullWidth:!0,className:"my-2",type:"text",id:"link",name:"link",variant:"filled",label:"Link",value:t.link,onChange:d=>j(r,d)}),e.jsxs("div",{className:"col-12 col-md-3 mb-3 mx-auto",children:[e.jsx("input",{type:"file",hidden:!0,className:"specialServiceImageInput",onChange:d=>K("specialService",r,d)}),e.jsxs("div",{onClick:()=>M("specialService",r),className:`p-2 mt-2 add-logo-div ${(v=t.errors)!=null&&v.imageError?"error-border":""}`,children:[e.jsx("span",{style:{color:"grey"},children:"(Ratio 4 : 3) "}),e.jsx("div",{className:"text-center",children:b!=null&&b.specialService[r]?e.jsx("div",{className:"spinner-border text-primary",role:"status"}):e.jsx("img",{src:t.image||"/images/add_image.png",width:"50",alt:"Add Service Image"})}),((A=t.errors)==null?void 0:A.imageError)&&e.jsx("p",{className:"text-danger",children:t.errors.imageError})]})]})]},`index-${r}`)}),e.jsx("div",{className:"text-center",children:e.jsx(f,{className:"w-100 submit-button",variant:"contained",href:"#",onClick:()=>m(t=>({...t,data:[...t==null?void 0:t.data,{title:"",description:"",image:"",price:""}]})),children:"+ Add Products cards"})})]}),T&&e.jsx("p",{className:"text-danger text-danger mt-3",children:T.toString()})]}),e.jsx("div",{className:"col-12 mt-4 text-center",children:q?e.jsx(R,{variant:"primary"}):e.jsx(f,{variant:"contained",className:"w-100 submit-button",onClick:ee,children:"Save & Next"})})]}),e.jsxs("div",{className:"d-none d-md-block left-portion p-0 col-md-6 h-100",children:[e.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),e.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:!0}),e.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap",rel:"stylesheet"}),e.jsxs("style",{children:[" ",`
                              ::-webkit-scrollbar {
                                  width: 12px; /* Width of the entire scrollbar */
                              }
          
                              /* Scrollbar track */
                              ::-webkit-scrollbar-track {
                                  background: rgb(243, 243, 244); /* Background of the scrollbar track */
                              }::-webkit-scrollbar-thumb {
                                  background-color: ${s==null?void 0:s.theme}; /* Color of the scrollbar thumb */
                                  border-radius: 10px;     /* Rounded edges of the thumb */
                                  border: 3px solid  ${s==null?void 0:s.theme}; /* Padding around the thumb */
                              }
                          .theme
                          {
                              background-color: ${s==null?void 0:s.theme};
                              color: white;
                              border: none;
                          }.service-design.active{
                              background-color: ${s==null?void 0:s.theme};
                          }.address-section{
                          background-color:${s==null?void 0:s.theme};
                          }.address-logo i{
                          color: ${s==null?void 0:s.theme};
                          }.cat-option{
                              border-right: 1px dashed ${s==null?void 0:s.theme};
                          }.text-orange{
                                  color: ${s==null?void 0:s.theme};
                              }.dish-div:hover{
                                  background-color: ${s==null?void 0:s.theme};
                                  color:white;
                              }.product-section{
                              padding:20px;
                              border:1px solid ${s==null?void 0:s.theme};
                              border-radius:16px;
                                  }.slick-dots .slick-active button{
                                      background-color: ${s==null?void 0:s.theme};
                                      border-radius: 16px;
                                  }
                              `]}),e.jsx("div",{children:e.jsx("section",{className:"h-auto",style:{backgroundColor:"#F3F3F4",overflowY:"scroll"},children:e.jsxs("div",{className:"container p-top",children:[e.jsx("div",{className:"col-12 mb-5",children:e.jsxs("div",{className:"mt-5 text-center",children:[e.jsx("div",{className:"col-12",children:e.jsx("h1",{className:"text-center text-dark fw-bold david-font fw-bold banner-title fs-45",children:o.title})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-6 mb-1",children:e.jsx("p",{className:"text-secondary text-center",children:o.description})})})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"col-12 mb-5 row justify-content-center david-font",children:((F=o==null?void 0:o.data)==null?void 0:F.length)>2?e.jsx(ie,{...re,children:o.data.map((t,r)=>e.jsxs("div",{className:"dish-div col-12 col-lg-6 text-center p-3",children:[e.jsx("div",{className:"col-12 position-relative ",children:e.jsx("img",{src:t.image,alt:t.title,style:{width:"100%",height:"auto",maxWidth:"300px",objectFit:"cover"}})}),e.jsx("div",{className:"col-12",children:e.jsx("h2",{className:"fs-20 fw-bold",children:t.title})}),e.jsx("div",{className:"col-12 mt-3 mb-3",children:e.jsx("p",{children:t.description})}),e.jsx("div",{className:"col-12 mt-3 mb-3",children:e.jsx("p",{children:t.price})})]},r))}):(W=o==null?void 0:o.data)==null?void 0:W.map((t,r)=>e.jsxs("div",{className:"dish-div col-12 col-lg-6 text-center p-3 ",children:[e.jsx("div",{className:"col-12 position-relative ",children:e.jsx("img",{src:t.image,alt:t.title,style:{width:"100%",height:"auto",maxWidth:"300px",objectFit:"cover"}})}),e.jsx("div",{className:"col-12",children:e.jsx("h2",{className:"fs-20 fw-bold",children:t.title})}),e.jsx("div",{className:"col-12 mt-3 mb-3",children:e.jsx("p",{children:t.description})}),e.jsx("div",{className:"col-12 mt-3 mb-3",children:e.jsx("p",{children:t==null?void 0:t.price})})]},r))})})]})})})]})]})]})})};export{je as default};
